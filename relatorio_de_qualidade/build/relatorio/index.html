
<!DOCTYPE html>

<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introdução &#8212; Transforma Minas 1.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Welcome to Transforma Minas’s documentation!" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="introducao">
<h1>Introdução<a class="headerlink" href="#introducao" title="Permalink to this headline">¶</a></h1>
<p>Este relatório tem como objetivo construir uma fotografia da qualidade do código da plataforma
Transforma Minas. Esta fotografia irá focar em métricas de qualidade, arquitetura de software e
boas práticas de programação.</p>
<p>Para a coleta de métricas de qualidade, utilizaremos um conjunto de ferramentas
disponíveis no universo PHP. Para uma visão da arquitetura de software e boas práticas de
programação utilizaremos como base o que a literura de engenharia de software e ciência da computação
aborda sobre estes assuntos.</p>
<p>A partir desta fotografia iremos propor um possível roadmap para o
projeto. Este roadmap terá como foco a melhoria da manutenibilidade da plataforma para que orgãos
publicos, empresas e desenvolvedores consigam contribuir com o projeto.</p>
<div class="section" id="ferramentas">
<h2>Ferramentas<a class="headerlink" href="#ferramentas" title="Permalink to this headline">¶</a></h2>
<p>As seguintes ferramentas serão utilizadas para analisar o código da plataforma:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Ferramenta</p></th>
<th class="head"><p>Descrição</p></th>
<th class="head"><p>Tipo</p></th>
<th class="head"><p>Link</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PHP-CS-Fixer</p></td>
<td><p>Ferramenta que formata o código seguindo diversas convensões para PHP</p></td>
<td><p><em>Estilo de código</em></p></td>
<td><p><a class="reference external" href="https://github.com/FriendsOfPHP/PHP-CS-Fixer">https://github.com/FriendsOfPHP/PHP-CS-Fixer</a></p></td>
</tr>
<tr class="row-odd"><td><p>PhpLoc</p></td>
<td><p>Ferramenta para medir o tamanho e analisar a estrutura de projetos php</p></td>
<td><p>Metricas de tamanho</p></td>
<td><p><a class="reference external" href="https://github.com/sebastianbergmann/phploc">https://github.com/sebastianbergmann/phploc</a></p></td>
</tr>
<tr class="row-even"><td><p>PHP Insight</p></td>
<td><p>Ferramenta para coletar metricas de qualidade como complexidade ciclomatica e arquitetura</p></td>
<td><p>Metricas de qualidade</p></td>
<td><p><a class="reference external" href="https://github.com/nunomaduro/phpinsights">https://github.com/nunomaduro/phpinsights</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="metricas">
<h2>Metricas<a class="headerlink" href="#metricas" title="Permalink to this headline">¶</a></h2>
<div class="section" id="phploc">
<h3>PhpLoc<a class="headerlink" href="#phploc" title="Permalink to this headline">¶</a></h3>
<p>Vamos iniciar nossa análise pela ferrramenta <strong>PhpLoc</strong>. Segundo estudos na área de metricas de
qualidade, medir o tamanho das classes e módulos segue sendo umas das melhores métricas de
qualidade e por isso iremos começar com esta medição.</p>
<p>Considerando que a ferramenta foi instalada dentro de uma pasta <code class="docutils literal notranslate"><span class="pre">tools</span></code>,
podemos realizar a analise do código:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>	php tools/phploc.phar application/
</pre></div>
</div>
<p>A ferramenta coleta diversas medidas do código, mas iremos focar nossa análise nas métricas <strong>Lines
of Code</strong>(LOC), <strong>Comment Lines of Code</strong>(CLOC), <strong>Non-comment Lines of Code</strong> (NCLOC), <strong>Logical
Lines of Code</strong> (LLOC). Além dessas também avaliaremos as métricas relacionadas às classes e
funções da plataforma. O relatório completo gerado pela ferramenta, pode ser encontrado em
<code class="docutils literal notranslate"><span class="pre">relatorio_de_qualidade/phploc-report.txt</span></code></p>
<p>De acordo com a ferramenta, as seguintes métricas foram coletadas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Size</span>
  <span class="n">Lines</span> <span class="n">of</span> <span class="n">Code</span> <span class="p">(</span><span class="n">LOC</span><span class="p">)</span>                           <span class="mi">111255</span>
  <span class="n">Comment</span> <span class="n">Lines</span> <span class="n">of</span> <span class="n">Code</span> <span class="p">(</span><span class="n">CLOC</span><span class="p">)</span>                   <span class="mi">24547</span> <span class="p">(</span><span class="mf">22.06</span><span class="o">%</span><span class="p">)</span>
  <span class="n">Non</span><span class="o">-</span><span class="n">Comment</span> <span class="n">Lines</span> <span class="n">of</span> <span class="n">Code</span> <span class="p">(</span><span class="n">NCLOC</span><span class="p">)</span>              <span class="mi">86708</span> <span class="p">(</span><span class="mf">77.94</span><span class="o">%</span><span class="p">)</span>
  <span class="n">Logical</span> <span class="n">Lines</span> <span class="n">of</span> <span class="n">Code</span> <span class="p">(</span><span class="n">LLOC</span><span class="p">)</span>                   <span class="mi">29454</span> <span class="p">(</span><span class="mf">26.47</span><span class="o">%</span><span class="p">)</span>
    <span class="n">Classes</span>                                      <span class="mi">21165</span> <span class="p">(</span><span class="mf">71.86</span><span class="o">%</span><span class="p">)</span>
      <span class="n">Average</span> <span class="n">Class</span> <span class="n">Length</span>                         <span class="mi">289</span>
        <span class="n">Minimum</span> <span class="n">Class</span> <span class="n">Length</span>                         <span class="mi">1</span>
        <span class="n">Maximum</span> <span class="n">Class</span> <span class="n">Length</span>                      <span class="mi">9039</span>
      <span class="n">Average</span> <span class="n">Method</span> <span class="n">Length</span>                         <span class="mi">18</span>
        <span class="n">Minimum</span> <span class="n">Method</span> <span class="n">Length</span>                        <span class="mi">1</span>
        <span class="n">Maximum</span> <span class="n">Method</span> <span class="n">Length</span>                      <span class="mi">722</span>
      <span class="n">Average</span> <span class="n">Methods</span> <span class="n">Per</span> <span class="n">Class</span>                     <span class="mi">15</span>
        <span class="n">Minimum</span> <span class="n">Methods</span> <span class="n">Per</span> <span class="n">Class</span>                    <span class="mi">0</span>
        <span class="n">Maximum</span> <span class="n">Methods</span> <span class="n">Per</span> <span class="n">Class</span>                  <span class="mi">415</span>
    <span class="n">Functions</span>                                      <span class="mi">444</span> <span class="p">(</span><span class="mf">1.51</span><span class="o">%</span><span class="p">)</span>
      <span class="n">Average</span> <span class="n">Function</span> <span class="n">Length</span>                        <span class="mi">8</span>
    <span class="n">Not</span> <span class="ow">in</span> <span class="n">classes</span> <span class="ow">or</span> <span class="n">functions</span>                   <span class="mi">7845</span> <span class="p">(</span><span class="mf">26.63</span><span class="o">%</span><span class="p">)</span>

<span class="n">Cyclomatic</span> <span class="n">Complexity</span>
  <span class="n">Average</span> <span class="n">Complexity</span> <span class="n">per</span> <span class="n">LLOC</span>                     <span class="mf">0.42</span>
  <span class="n">Average</span> <span class="n">Complexity</span> <span class="n">per</span> <span class="n">Class</span>                  <span class="mf">126.18</span>
    <span class="n">Minimum</span> <span class="n">Class</span> <span class="n">Complexity</span>                      <span class="mf">1.00</span>
    <span class="n">Maximum</span> <span class="n">Class</span> <span class="n">Complexity</span>                   <span class="mf">4368.00</span>
  <span class="n">Average</span> <span class="n">Complexity</span> <span class="n">per</span> <span class="n">Method</span>                   <span class="mf">8.99</span>
    <span class="n">Minimum</span> <span class="n">Method</span> <span class="n">Complexity</span>                     <span class="mf">1.00</span>
    <span class="n">Maximum</span> <span class="n">Method</span> <span class="n">Complexity</span>                   <span class="mf">502.00</span>

</pre></div>
</div>
<p>A plataforma possui no total 111255 linhas de código, sendo que destas <strong>22%</strong> é codigo comentado.
Estes comentários não são documentação para facilitar o entendimento de certas estruturas, é código
comentado que não foi removido pelos desenvolvedores. A motivação para isso é incerta, mas esse tipo
de prática impacta diretamente na leitura do código e na possibilidade de realizar alterações sem
quebrar a aplicação.</p>
<p>Ainda olhando outras métricas como NLOC e LLOC temos um cenário curioso. A ferramenta identificou
que <strong>77%</strong> do código é composto por linhas não comentadas, mas apenas <strong>26%</strong> são linhas logicas
(código PHP). Iremos refinar nossa analise para os principais módulos da aplicação, excluindo
os diretórios application/config, application/libraries, application/third_party/, dentro de <code class="docutils literal notranslate"><span class="pre">application</span></code>. Esses diretórios ou pertencem ao CodeIgniter, ou são bibliotecas utilizadas pela aplicação. Olharemos essas diretórios com mais calma em outro momento.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>php tools/phploc.phar application/ --exclude application/config --exclude application/libraries/ --exclude application/third_party/
</pre></div>
</div>
<p>De acordo com a ferramenta, as seguintes métricas foram coletadas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Size</span>
  <span class="n">Lines</span> <span class="n">of</span> <span class="n">Code</span> <span class="p">(</span><span class="n">LOC</span><span class="p">)</span>                            <span class="mi">40166</span>
  <span class="n">Comment</span> <span class="n">Lines</span> <span class="n">of</span> <span class="n">Code</span> <span class="p">(</span><span class="n">CLOC</span><span class="p">)</span>                    <span class="mi">6997</span> <span class="p">(</span><span class="mf">17.42</span><span class="o">%</span><span class="p">)</span>
  <span class="n">Non</span><span class="o">-</span><span class="n">Comment</span> <span class="n">Lines</span> <span class="n">of</span> <span class="n">Code</span> <span class="p">(</span><span class="n">NCLOC</span><span class="p">)</span>              <span class="mi">33169</span> <span class="p">(</span><span class="mf">82.58</span><span class="o">%</span><span class="p">)</span>
  <span class="n">Logical</span> <span class="n">Lines</span> <span class="n">of</span> <span class="n">Code</span> <span class="p">(</span><span class="n">LLOC</span><span class="p">)</span>                   <span class="mi">12031</span> <span class="p">(</span><span class="mf">29.95</span><span class="o">%</span><span class="p">)</span>
    <span class="n">Classes</span>                                       <span class="mi">5062</span> <span class="p">(</span><span class="mf">42.07</span><span class="o">%</span><span class="p">)</span>
      <span class="n">Average</span> <span class="n">Class</span> <span class="n">Length</span>                         <span class="mi">281</span>
        <span class="n">Minimum</span> <span class="n">Class</span> <span class="n">Length</span>                        <span class="mi">12</span>
        <span class="n">Maximum</span> <span class="n">Class</span> <span class="n">Length</span>                      <span class="mi">1284</span>
      <span class="n">Average</span> <span class="n">Method</span> <span class="n">Length</span>                         <span class="mi">24</span>
        <span class="n">Minimum</span> <span class="n">Method</span> <span class="n">Length</span>                        <span class="mi">1</span>
        <span class="n">Maximum</span> <span class="n">Method</span> <span class="n">Length</span>                      <span class="mi">384</span>
      <span class="n">Average</span> <span class="n">Methods</span> <span class="n">Per</span> <span class="n">Class</span>                     <span class="mi">11</span>
        <span class="n">Minimum</span> <span class="n">Methods</span> <span class="n">Per</span> <span class="n">Class</span>                    <span class="mi">2</span>
        <span class="n">Maximum</span> <span class="n">Methods</span> <span class="n">Per</span> <span class="n">Class</span>                   <span class="mi">28</span>
    <span class="n">Functions</span>                                      <span class="mi">424</span> <span class="p">(</span><span class="mf">3.52</span><span class="o">%</span><span class="p">)</span>
      <span class="n">Average</span> <span class="n">Function</span> <span class="n">Length</span>                        <span class="mi">9</span>
    <span class="n">Not</span> <span class="ow">in</span> <span class="n">classes</span> <span class="ow">or</span> <span class="n">functions</span>                   <span class="mi">6545</span> <span class="p">(</span><span class="mf">54.40</span><span class="o">%</span><span class="p">)</span>

<span class="n">Cyclomatic</span> <span class="n">Complexity</span>
  <span class="n">Average</span> <span class="n">Complexity</span> <span class="n">per</span> <span class="n">LLOC</span>                     <span class="mf">0.43</span>
  <span class="n">Average</span> <span class="n">Complexity</span> <span class="n">per</span> <span class="n">Class</span>                  <span class="mf">118.06</span>
    <span class="n">Minimum</span> <span class="n">Class</span> <span class="n">Complexity</span>                      <span class="mf">4.00</span>
    <span class="n">Maximum</span> <span class="n">Class</span> <span class="n">Complexity</span>                    <span class="mf">564.00</span>
  <span class="n">Average</span> <span class="n">Complexity</span> <span class="n">per</span> <span class="n">Method</span>                  <span class="mf">11.18</span>
    <span class="n">Minimum</span> <span class="n">Method</span> <span class="n">Complexity</span>                     <span class="mf">1.00</span>
    <span class="n">Maximum</span> <span class="n">Method</span> <span class="n">Complexity</span>                   <span class="mf">297.00</span>

</pre></div>
</div>
<p>Excluindo os diretórios citados anteriormente, notamos uma redução drastica no tamanho da aplicação. De 111255 para 40166 linhas, uma redução de mais de 50%. Isso pode indicar que boa parte do código do transforma são bibliotecas, modulos e scripts de terceiros, que <strong>podem ou não estar sendo usados</strong>. Isso é um problema grave, já que mais que metade do código é dependência externa. O número de código comentado também segue bem alto, o que implica que a maior parte dos comentários estão no código escrito para o sistema e não código de terceiros.</p>
<p>Ainda falando da porcentagem de código comentado, podemos exemplificar essa pratica olhando a
controller <code class="docutils literal notranslate"><span class="pre">application/controllers/Candidatos.php</span></code>, na função <code class="docutils literal notranslate"><span class="pre">index</span></code>. Da linha 37 até 69 temos
código comentado. Da linha 91 até 180 temos código comentado. Da linha 202 até 304 temos código
comentado. Ou seja, um método de 329 linhas possui 223 linhas comentadas.</p>
<p>Avaliando as métricas das classes, temos classes com 1284 linhas e métodos com 384 linhas.
Independente do que eles fazem, são implementações muito longas para a natureza da aplicação, que atrapalham escrita de testes, evolução e manutenção. Iremos comparar as métricas de complexidade da ferramenta PhpLoc com a PHP Insight, já que esta é uma métrica que depende de como as ferramentas fazem o processsamento do código.</p>
</div>
</div>
<div class="section" id="php-insight">
<h2>PHP Insight<a class="headerlink" href="#php-insight" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Transforma Minas</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introdução</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ferramentas">Ferramentas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metricas">Metricas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#php-insight">PHP Insight</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../index.html" title="previous chapter">Welcome to Transforma Minas’s documentation!</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, David Carlos de Araújo Silva.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/relatorio/index.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>